---
id: m-9b02
status: closed
deps: [m-6cc8]
links: []
created: 2026-01-17T23:02:10Z
type: task
priority: 2
assignee: Steve Macbeth
parent: m-2b6b
---
# tk CLI wrapper service

Service to execute tk commands in project directories and parse output

## Design

Files: src/server/services/tk.ts

Functions:
- execTk(projectPath: string, args: string[]): Promise<{ stdout, stderr, exitCode }>
  - Spawns tk with args in projectPath cwd
  - Logs command, duration, exit code
  - Throws on non-zero exit with stderr

- getTickets(projectPath): Promise<Ticket[]>
  - Runs tk query, parses JSON output

- getReadyTickets(projectPath): Promise<Ticket[]>
  - Runs tk ready, parses output

- getBlockedTickets(projectPath): Promise<Ticket[]>
  - Runs tk blocked, parses output

- getClosedTickets(projectPath, limit=10): Promise<Ticket[]>
  - Runs tk closed --limit=N

- getTicket(projectPath, id): Promise<Ticket>
  - Runs tk show <id> with JSON flag if available, else parse

- createTicket(projectPath, data): Promise<string>
  - Runs tk create with all fields, returns new ID

- startTicket(projectPath, id): Promise<void>
- closeTicket(projectPath, id): Promise<void>
- reopenTicket(projectPath, id): Promise<void>

Types: Ticket interface matching tk fields

## Acceptance Criteria

- All tk commands execute correctly
- JSON parsing handles tk output format
- Errors logged with full context

