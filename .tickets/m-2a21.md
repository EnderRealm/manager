---
id: m-2a21
status: open
deps: []
links: []
created: 2026-01-24T04:11:23Z
type: epic
priority: 1
assignee: Steve Macbeth
---
# Claude Agent SDK integration for automated ticket execution

Integrate @anthropic-ai/claude-agent-sdk to enable running tickets through Claude Code programmatically with hybrid auto/supervised permission handling

## Design

Architecture:
- AgentRunner service wrapping the SDK query() function
- WebSocket channel for permission requests and questions
- Auto-approve rules based on ticket type/priority
- Session persistence for resumable interactions

Components:
1. src/server/services/agent-runner.ts - SDK wrapper
2. src/server/routes/agents.ts - API endpoints
3. WebSocket handlers for permission/question forwarding
4. UI for agent status and interaction

Permission model:
- Chores/tasks P3-P4: acceptEdits mode (auto-approve file changes)
- Features/bugs P0-P2: default mode (forward all to UI)
- Configurable allowlist for bash commands

## Acceptance Criteria

- Can start an agent run for a ticket from UI
- Agent streams progress to UI in real-time
- Permission requests forwarded to user when needed
- Auto-approve works for configured scenarios
- Can pause/resume agent sessions

