---
id: m-3190
status: closed
deps: [m-ac44, m-8a22, m-1962]
links: []
created: 2026-02-01T21:40:04Z
type: task
priority: 2
assignee: Steve Macbeth
parent: m-e4de
---
# Create setup-prod.sh script

Create a one-time setup script that bootstraps the entire production environment from scratch.

## Design

Files: scripts/setup-prod.sh (new)

Steps:
1. Check prerequisites: bun, git, caddy (or install via brew), tailscale
2. Create directory structure:
   - mkdir -p ~/.local/services/manager
   - mkdir -p ~/.local/services/caddy/{data,config}
   - mkdir -p ~/Library/Logs/Manager
3. Clone repo:
   - git clone <repo-url> ~/.local/services/manager
   - Or if already exists, git fetch && git reset --hard origin/main
4. Install and build:
   - cd ~/.local/services/manager
   - bun install --frozen-lockfile
   - bunx vite build
5. Copy config.json to prod checkout (or symlink to shared location)
6. Run scripts/setup-caddy.sh (interactive: asks for domain + CF token)
7. Run scripts/generate-plists.sh --install
8. Print summary:
   - Services loaded
   - How to check status: launchctl list | grep com.manager
   - How to view logs: tail -f ~/Library/Logs/Manager/*.log
   - Reminder: add DNS A record on Cloudflare
   - Reminder: verify Tailscale is running on Mac Studio

Idempotent: safe to re-run (skips steps already done, updates others)

## Acceptance Criteria

- Fresh machine can run this script and have Manager production running
- Script is idempotent (safe to re-run)
- All three launchd services are loaded and running after completion
- Clear output showing what was done and next manual steps (DNS, Tailscale)

